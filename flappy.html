<!DOCTYPE html>
<html lang="tk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flappy YouHapp</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@700&display=swap');

        body {
            margin: 0;
            padding: 0;
            background: #222;
            overflow: hidden;
            touch-action: none;
            font-family: 'Press Start 2P', cursive;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #game-container {
            position: relative;
            width: 100%;
            max-width: 480px;
            height: 100vh;
            background: #70c5ce;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* --- G√úNCELLENEN WATERMARK --- */
        .watermark {
            position: absolute;
            top: 5px;
            width: 100%;
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            font-size: 12px; /* Biraz daha okunur yaptƒ±k */
            color: rgba(255, 255, 255, 0.3); /* Hafif g√∂r√ºn√ºr */
            letter-spacing: 1px;
            pointer-events: none;
            z-index: 100;
            text-transform: uppercase;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        /* UI Katmanlarƒ± */
        .ui-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #score-display {
            position: absolute;
            top: 10%;
            width: 100%;
            text-align: center;
            font-size: 60px;
            color: white;
            text-shadow: 4px 4px 0 #000;
            z-index: 20;
            pointer-events: none;
        }

        #start-screen {
            background: rgba(0,0,0,0.2);
            z-index: 40;
        }
        
        .message-box {
            background: #ded895;
            border: 4px solid #543847;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.3);
            animation: float 2s infinite ease-in-out;
            pointer-events: auto;
        }

        @keyframes float { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }

        h1 { font-size: 20px; color: #e9603d; text-shadow: 2px 2px 0 #fff; margin-bottom: 20px; line-height: 1.5; }
        p { font-size: 10px; color: #543847; line-height: 1.6; }

        #game-over-screen {
            display: none;
            background: rgba(0,0,0,0.6);
            pointer-events: auto;
            z-index: 50;
        }
        
        .scoreboard {
            background: #ded895;
            border: 4px solid #543847;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            width: 80%;
        }

        .medal { font-size: 50px; margin: 20px 0; display: block; }
        
        .btn {
            background: #e9603d;
            border: 2px solid #fff;
            color: white;
            padding: 15px 30px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 0 #9e3318;
            transition: transform 0.1s;
        }
        .btn:active { transform: translateY(4px); box-shadow: 0 0 0; }

    </style>
</head>
<body>

    <div id="game-container">
        <div class="watermark">@YouHapp_Robot</div>

        <div id="score-display">0</div>
        <canvas id="gameCanvas"></canvas>

        <div id="start-screen" class="ui-layer">
            <div class="message-box">
                <h1>U√áMAK √ú√áIN<br>BAS</h1>
                <p>Ekrany≈à islendik<br>√Ωerine basy≈à</p>
            </div>
        </div>

        <div id="game-over-screen" class="ui-layer">
            <div class="scoreboard">
                <h1 style="color: #e9603d;">O√ùUN GUTARDY</h1>
                <div class="medal" id="medal">ü•á</div>
                <p>UTUK: <span id="final-score">0</span></p>
                <p style="margin-top:10px; color:#e67e22;">I≈á GOWY: <span id="best-score">0</span></p>
                <button class="btn" id="restart-btn">T√ÑZEDEN O√ùNA</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('start-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const scoreEl = document.getElementById('score-display');
        const finalScoreEl = document.getElementById('final-score');
        const bestScoreEl = document.getElementById('best-score');
        const medalEl = document.getElementById('medal');
        const restartBtn = document.getElementById('restart-btn');

        let scale = 1;
        function resize() {
            canvas.width = canvas.parentElement.offsetWidth;
            canvas.height = canvas.parentElement.offsetHeight;
            scale = canvas.width / 320; 
        }
        window.addEventListener('resize', resize);
        resize();

        let frames = 0;
        let score = 0;
        let highScore = localStorage.getItem('flappyHigh') || 0;
        const state = { current: 0, getReady: 0, game: 1, over: 2 };
        let particles = [];
        let audioCtx = null;

        function playSound(type) {
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'flap') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(200, now);
                osc.frequency.linearRampToValueAtTime(80, now + 0.1);
                gain.gain.setValueAtTime(0.15, now); gain.gain.linearRampToValueAtTime(0.01, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'score') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(1000, now);
                gain.gain.setValueAtTime(0.1, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                osc.start(now); osc.stop(now + 0.3);
            } else if (type === 'hit') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, now);
                osc.frequency.exponentialRampToValueAtTime(50, now + 0.2);
                gain.gain.setValueAtTime(0.3, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
                osc.start(now); osc.stop(now + 0.2);
            }
        }

        const bg = {
            draw: function() {
                ctx.fillStyle = "#70c5ce"; ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "rgba(255, 255, 255, 0.5)";
                for(let i=0; i<5; i++) {
                    let x = ((frames * 0.3) + (i * 100)) % (canvas.width + 100) - 50;
                    let y = canvas.height - 150 - (i * 30);
                    ctx.beginPath();
                    ctx.arc(x, y, 30 * scale, 0, Math.PI * 2);
                    ctx.arc(x + 20*scale, y - 10*scale, 40 * scale, 0, Math.PI * 2);
                    ctx.arc(x + 50*scale, y, 30 * scale, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.fillStyle = "#a3e0c4";
                for(let i=0; i<10; i++) {
                    let h = 50 + Math.sin(i)*30;
                    let w = canvas.width / 10;
                    let x = i * w - (frames * 0.1) % w;
                    ctx.fillRect(x, canvas.height - 110 * scale - h*scale, w + 2, h*scale);
                }
            }
        }

        const fg = {
            h: 110,
            draw: function() {
                ctx.fillStyle = "#ded895";
                ctx.fillRect(0, canvas.height - this.h * scale, canvas.width, this.h * scale);
                ctx.fillStyle = "#73bf2e";
                ctx.fillRect(0, canvas.height - this.h * scale, canvas.width, 12 * scale);
                ctx.strokeStyle = "#d0c874"; ctx.lineWidth = 2; ctx.beginPath();
                let offset = (frames * 1.5) % (20 * scale);
                for (let i = -20; i < canvas.width; i += 20 * scale) {
                    ctx.moveTo(i - offset, canvas.height - this.h * scale + 12*scale);
                    ctx.lineTo(i - 10*scale - offset, canvas.height);
                }
                ctx.stroke();
                ctx.fillStyle = "#543847";
                ctx.fillRect(0, canvas.height - this.h * scale, canvas.width, 2);
            }
        }

        const bird = {
            x: 50, y: 150, w: 34, h: 24, radius: 12,
            speed: 0, gravity: 0.18, jump: 3.8, rotation: 0,
            draw: function() {
                let r = this.radius * scale;
                let birdX = this.x * scale; let birdY = this.y;
                ctx.save();
                ctx.translate(birdX, birdY);
                let rot = Math.min(Math.PI / 4, Math.max(-Math.PI / 4, (this.speed * 0.12)));
                ctx.rotate(rot);
                ctx.fillStyle = "#f4ce42"; ctx.beginPath(); ctx.ellipse(0, 0, r*1.2, r, 0, 0, Math.PI*2); ctx.fill();
                ctx.lineWidth = 2; ctx.strokeStyle = "#543847"; ctx.stroke();
                ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.arc(r*0.4, -r*0.4, r*0.4, 0, Math.PI*2); ctx.fill(); ctx.stroke();
                ctx.fillStyle = "#000"; ctx.beginPath(); ctx.arc(r*0.5, -r*0.4, r*0.1, 0, Math.PI*2); ctx.fill();
                ctx.fillStyle = "#e9603d"; ctx.beginPath(); ctx.moveTo(r*0.5, r*0.1); ctx.lineTo(r*1.3, r*0.3); ctx.lineTo(r*0.5, r*0.5); ctx.fill(); ctx.stroke();
                ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.ellipse(-r*0.3, r*0.1, r*0.4, r*0.3, -0.2, 0, Math.PI*2); ctx.fill(); ctx.stroke();
                ctx.restore();
            },
            flap: function() {
                this.speed = -this.jump * scale;
                playSound('flap');
                createParticles(this.x * scale, this.y);
            },
            update: function() {
                this.speed += this.gravity * scale;
                this.y += this.speed;
                if(this.y + this.h/2 * scale >= canvas.height - fg.h * scale) {
                    this.y = canvas.height - fg.h * scale - this.h/2 * scale;
                    if(state.current == state.game) { state.current = state.over; playSound('hit'); showGameOver(); }
                }
                if(this.y < 0) { this.y = 0; this.speed = 0; }
            },
            reset: function() { this.y = canvas.height / 2; this.speed = 0; this.rotation = 0; }
        }

        const pipes = {
            position: [], w: 52, h: 400, gap: 140, dx: 1.5,
            draw: function() {
                for(let i=0; i<this.position.length; i++) {
                    let p = this.position[i];
                    let topY = p.y; let bottomY = p.y + this.h * scale + this.gap * scale;
                    let pW = this.w * scale; let pH = this.h * scale;
                    ctx.fillStyle = "#73bf2e"; ctx.strokeStyle = "#543847"; ctx.lineWidth = 2;
                    ctx.fillRect(p.x, topY, pW, pH); ctx.strokeRect(p.x, topY, pW, pH);
                    ctx.fillRect(p.x - 2, topY + pH - 20*scale, pW + 4, 20*scale); ctx.strokeRect(p.x - 2, topY + pH - 20*scale, pW + 4, 20*scale);
                    ctx.fillRect(p.x, bottomY, pW, pH); ctx.strokeRect(p.x, bottomY, pW, pH);
                    ctx.fillRect(p.x - 2, bottomY, pW + 4, 20*scale); ctx.strokeRect(p.x - 2, bottomY, pW + 4, 20*scale);
                    ctx.fillStyle = "rgba(255,255,255,0.2)"; ctx.fillRect(p.x + 5, topY, 5, pH); ctx.fillRect(p.x + 5, bottomY, 5, pH);
                }
            },
            update: function() {
                if(frames % 160 == 0) {
                    this.position.push({
                        x: canvas.width,
                        y: (Math.random() * (canvas.height - fg.h * scale - 250 * scale)) - (this.h * scale) + 50 * scale
                    });
                }
                for(let i=0; i<this.position.length; i++) {
                    let p = this.position[i];
                    let bottomPipeY = p.y + this.h * scale + this.gap * scale;
                    let birdLeft = bird.x * scale - bird.radius * scale; let birdRight = bird.x * scale + bird.radius * scale;
                    let birdTop = bird.y - bird.radius * scale; let birdBottom = bird.y + bird.radius * scale;
                    let pipeLeft = p.x; let pipeRight = p.x + this.w * scale;
                    let topPipeBottom = p.y + this.h * scale; let bottomPipeTop = bottomPipeY;

                    if(birdRight > pipeLeft && birdLeft < pipeRight) {
                        if(birdTop < topPipeBottom || birdBottom > bottomPipeTop) {
                            state.current = state.over; playSound('hit'); showGameOver();
                        }
                    }
                    p.x -= this.dx * scale;
                    if(p.x + this.w * scale <= 0) {
                        this.position.shift(); score++; playSound('score'); scoreEl.innerText = score;
                        scoreEl.style.transform = "scale(1.5)"; setTimeout(() => scoreEl.style.transform = "scale(1)", 100);
                        i--;
                    }
                }
            },
            reset: function() { this.position = []; }
        }

        function createParticles(x, y) {
            for(let i=0; i<5; i++) {
                particles.push({x: x, y: y, vx: (Math.random() - 0.5) * 5, vy: (Math.random() - 0.5) * 5, life: 1.0});
            }
        }
        function drawParticles() {
            for(let i=0; i<particles.length; i++) {
                let p = particles[i];
                ctx.fillStyle = `rgba(255, 255, 255, ${p.life})`;
                ctx.fillRect(p.x, p.y, 4*scale, 4*scale);
                p.x += p.vx; p.y += p.vy; p.life -= 0.05;
                if(p.life <= 0) { particles.splice(i, 1); i--; }
            }
        }

        function draw() { bg.draw(); pipes.draw(); fg.draw(); bird.draw(); drawParticles(); }
        function update() { bird.update(); if(state.current == state.game) pipes.update(); }
        function loop() { update(); draw(); if(state.current == state.game) frames++; requestAnimationFrame(loop); }

        function handleAction(e) {
            if(e.type === 'touchstart') e.preventDefault();
            switch(state.current) {
                case state.getReady:
                    state.current = state.game; startScreen.style.display = 'none'; scoreEl.style.display = 'block'; bird.flap(); break;
                case state.game: bird.flap(); break;
                case state.over: break;
            }
        }

        function resetGame() {
            bird.reset(); pipes.reset(); score = 0; frames = 0; scoreEl.innerText = score;
            state.current = state.getReady; gameOverScreen.style.display = 'none'; startScreen.style.display = 'flex';
        }

        function showGameOver() {
            gameOverScreen.style.display = 'flex'; scoreEl.style.display = 'none'; finalScoreEl.innerText = score;
            if(score > highScore) { highScore = score; localStorage.setItem('flappyHigh', highScore); }
            bestScoreEl.innerText = highScore;
            if(score >= 50) medalEl.innerText = "üèÜ"; else if(score >= 20) medalEl.innerText = "ü•á"; else if(score >= 10) medalEl.innerText = "ü•à"; else medalEl.innerText = "ü•â";
        }

        window.addEventListener('mousedown', handleAction);
        window.addEventListener('touchstart', handleAction, {passive: false});
        window.addEventListener('keydown', function(e) { if(e.code === 'Space') handleAction(e); });
        restartBtn.addEventListener('click', function(e) { e.stopPropagation(); resetGame(); });
        restartBtn.addEventListener('touchstart', function(e) { e.stopPropagation(); resetGame(); });

        bird.reset();
        loop();

    </script>
</body>
</html>
